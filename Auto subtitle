<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Auto Caption â€“ Hindi/English (Live)</title>

<style>
    :root{ --bg:#f0f2f5; --card:#ffffff; --pri:#007bff; }
    body{font-family:Arial, sans-serif;background:var(--bg);margin:0;padding:20px;}
    h2{text-align:center;margin-bottom:10px;font-size:24px;}
    .box{
        max-width:460px;margin:10px auto;background:var(--card);
        padding:15px;border-radius:12px;box-shadow:0 0 10px rgba(0,0,0,0.1);
    }
    video{width:100%;border-radius:10px;margin-top:10px;}
    .controls label{font-size:14px;font-weight:bold;}
    select, input[type=color], input[type=number]{
        width:100%;padding:8px;margin-top:6px;border-radius:8px;border:1px solid #ccc;
    }
    button{
        width:100%;padding:12px;margin-top:10px;font-size:16px;
        border:none;border-radius:8px;background:var(--pri);color:white;font-weight:bold;
    }
    #captionOverlay{
        position:absolute;bottom:6%;width:100%;text-align:center;
        font-weight:bold;text-shadow:0 0 5px black;padding:4px;
    }
    #video-wrap{position:relative;}
</style>
</head>

<body>

<h2>ðŸŽ¤ Auto Caption â€“ Hindi / English</h2>

<div class="box">
    <label>Select Video File</label>
    <input id="videoInput" type="file" accept="video/*">

    <div id="video-wrap">
        <video id="video" controls></video>
        <div id="captionOverlay"></div>
    </div>

    <div class="controls">
        <label>Language</label>
        <select id="langSelect">
            <option value="en-IN">English (India)</option>
            <option value="hi-IN">Hindi (India)</option>
        </select>

        <label>Caption Style</label>
        <select id="styleSelect">
            <option value="Boxed">Boxed</option>
            <option value="Shadow">Shadow</option>
            <option value="Plain">Plain</option>
        </select>

        <label>Text Color</label>
        <input id="textColor" type="color" value="#ffffff">

        <label>Highlight Color</label>
        <input id="highlightColor" type="color" value="#000000">

        <label>Font Size</label>
        <input id="fontsize" type="number" value="22">
    </div>

    <button id="generateBtn">Start Caption</button>
    <button id="stopBtn" style="background:#dc3545;">Stop</button>
    <button id="downloadSrt">Download SRT</button>

</div>

<script>
const video = document.getElementById("video");
const overlay = document.getElementById("captionOverlay");
const langSel = document.getElementById("langSelect");
const styleSel = document.getElementById("styleSelect");
const textColor = document.getElementById("textColor");
const highColor = document.getElementById("highlightColor");
const fsize = document.getElementById("fontsize");

let rec = null;
let running = false;
let segments = [];
let startTime = 0;

// Load video
document.getElementById("videoInput").onchange = (e)=>{
    video.src = URL.createObjectURL(e.target.files[0]);
    video.load();
};

// Start caption
document.getElementById("generateBtn").onclick = ()=>{
    if(running) return;
    running = true;
    segments = [];
    overlay.innerHTML = "";
    
    rec = new webkitSpeechRecognition();
    rec.lang = langSel.value;
    rec.continuous = true;
    rec.interimResults = true;

    rec.onresult = (event)=>{
        let text = event.results[event.results.length-1][0].transcript;
        overlay.innerHTML = text;

        overlay.style.color = textColor.value;
        overlay.style.fontSize = fsize.value + "px";

        if(styleSel.value == "Boxed"){
            overlay.style.background = highColor.value + "AA";
        } else if(styleSel.value == "Shadow"){
            overlay.style.background = "transparent";
            overlay.style.textShadow = "0 0 5px " + highColor.value;
        } else {
            overlay.style.background = "transparent";
            overlay.style.textShadow = "none";
        }
    };
    rec.start();
};

// Stop caption
document.getElementById("stopBtn").onclick = ()=>{
    if(rec) rec.stop();
    running = false;
};

// Download SRT
document.getElementById("downloadSrt").onclick = ()=>{
    let text = "1\n00:00:01,000 --> 00:02:00,000\n" + overlay.innerHTML;
    let blob = new Blob([text], {type:"text/plain"});
    let a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download="captions.srt";
    a.click();
};
</script>

</body>
</html>
